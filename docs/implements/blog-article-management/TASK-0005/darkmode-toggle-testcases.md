# TASK-0005: ダークモード切り替え機能 - TDDテストケース定義書

**作成日**: 2025-12-31
**タスクタイプ**: TDD
**機能名**: darkmode-toggle
**タスクID**: TASK-0005
**出力ファイル**: `docs/implements/blog-article-management/TASK-0005/darkmode-toggle-testcases.md`

---

## 概要

このドキュメントは、TASK-0005「ダークモード切り替え機能の実装」のTDD開発に必要なテストケースを定義します。
要件定義書（`darkmode-toggle-requirements.md`）およびタスクノート（`note.md`）に基づいて、網羅的なテストケースを洗い出しています。

**テスト対象コンポーネント**:
- `src/components/ThemeToggle.astro` - テーマ切り替えボタンコンポーネント
- `src/layouts/BaseLayout.astro` - テーマ初期化スクリプト（変更部分）

---

## 1. 開発言語・フレームワーク

### 🔵 プログラミング言語: TypeScript 5.7+ （青信号: タスクノートより）

- **言語選択の理由**: プロジェクト全体でTypeScript strict modeを使用しており、型安全な開発が求められる
- **テストに適した機能**: 型定義によりテストコードの品質向上、エディタ補完による開発効率化

### 🔵 テストフレームワーク: Vitest 2.1.8 （青信号: タスクノートより）

- **フレームワーク選択の理由**: Astroプロジェクトの標準テストフレームワーク、高速実行、ESM対応
- **テスト実行環境**: happy-dom 20.0.11（DOM操作・Astroコンポーネントテスト用）

### 🔵 テスト実行コマンド （青信号: CLAUDE.mdより）

```bash
pnpm test           # テスト実行
pnpm test:watch     # ウォッチモードでテスト実行
pnpm check          # TypeScript型チェック
pnpm lint           # リント・フォーマット実行
```

---

## 2. テストケース分類

### 2.1 ThemeToggleコンポーネント - 正常系テストケース

#### TC-TT-001: 基本レンダリングテスト
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: ThemeToggleコンポーネントが正しくレンダリングされる
  - **何をテストするか**: ThemeToggleコンポーネントの基本的なHTML構造
  - **期待される動作**: `<button>`要素が正しく生成される
- **入力値**: なし（Propsなしコンポーネント）
  - **入力データの意味**: ThemeToggleはPropsを受け取らない純粋UIコンポーネント
- **期待される結果**: `<button id="theme-toggle">`要素が存在する
  - **期待結果の理由**: タスクノートの設計仕様でid="theme-toggle"が指定されている
- **テストの目的**: コンポーネントの基本構造が正しいことを確認
  - **確認ポイント**: button要素の存在、id属性の正確性

#### TC-TT-002: アイコン要素の存在確認
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: ダーク/ライト両方のアイコンが存在する
  - **何をテストするか**: テーマ切り替え用の2つのSVGアイコンの存在
  - **期待される動作**: 月アイコン（ダークモード用）と太陽アイコン（ライトモード用）が両方レンダリングされる
- **入力値**: なし
  - **入力データの意味**: 初期レンダリング状態
- **期待される結果**: 2つのSVG要素が存在する
  - **期待結果の理由**: CSSクラスによる表示/非表示切り替えのため、両方のアイコンがHTML内に存在する必要がある
- **テストの目的**: アイコン切り替え機能の前提条件を確認
  - **確認ポイント**: SVG要素の数、viewBox属性の存在

#### TC-TT-003: ダークモード用アイコンクラス確認
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: ダークモード用アイコンに`dark:block`クラスが適用されている
  - **何をテストするか**: 月アイコン（ダークモード時に表示）のCSSクラス
  - **期待される動作**: `dark:block`クラスによりダークモード時のみ表示
- **入力値**: なし
  - **入力データの意味**: 初期レンダリング状態
- **期待される結果**: SVG要素に`dark:block`クラスが含まれる
  - **期待結果の理由**: Tailwind CSSのダークモード切り替えに必要
- **テストの目的**: CSSベースのテーマ切り替えが正しく設定されていることを確認
  - **確認ポイント**: クラス名の正確性

#### TC-TT-004: ライトモード用アイコンクラス確認
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: ライトモード用アイコンに`block dark:hidden`クラスが適用されている
  - **何をテストするか**: 太陽アイコン（ライトモード時に表示）のCSSクラス
  - **期待される動作**: `block dark:hidden`クラスによりライトモード時のみ表示
- **入力値**: なし
  - **入力データの意味**: 初期レンダリング状態
- **期待される結果**: SVG要素に`block`と`dark:hidden`クラスが含まれる
  - **期待結果の理由**: ダークモード時に非表示にするため
- **テストの目的**: CSSベースのテーマ切り替えが正しく設定されていることを確認
  - **確認ポイント**: クラス名の正確性

### 2.2 ThemeToggleコンポーネント - アクセシビリティテストケース

#### TC-TT-101: ARIAラベル設定確認
🔵 **青信号**: 要件定義書NFR-303より

- **テスト名**: ボタンにaria-labelが正しく設定されている
  - **何をテストするか**: アクセシビリティ用のARIAラベル属性
  - **期待される動作**: スクリーンリーダーがボタンの目的を読み上げられる
- **入力値**: なし
  - **入力データの意味**: 初期レンダリング状態
- **期待される結果**: `aria-label="テーマを切り替える"`が設定されている
  - **期待結果の理由**: アイコンのみのボタンにはテキスト代替が必須（WCAG 2.1）
- **テストの目的**: WCAG 2.1 AA準拠を確認
  - **確認ポイント**: aria-label属性の存在と値の正確性

#### TC-TT-102: フォーカス可視化スタイル確認
🔵 **青信号**: 要件定義書NFR-304より

- **テスト名**: フォーカス可視化スタイルクラスが適用されている
  - **何をテストするか**: キーボードフォーカス時の視覚的フィードバック
  - **期待される動作**: Tabキーでフォーカス時にリングが表示される
- **入力値**: なし
  - **入力データの意味**: 初期レンダリング状態
- **期待される結果**: `focus-visible:ring-2`および`focus-visible:ring-blue-500`クラスが存在
  - **期待結果の理由**: キーボードナビゲーション時の視覚的アクセシビリティに必要
- **テストの目的**: キーボードユーザーのアクセシビリティを確認
  - **確認ポイント**: focus-visible関連クラスの存在

#### TC-TT-103: ボタン要素のフォーカス可能性確認
🔵 **青信号**: 要件定義書NFR-302より

- **テスト名**: ボタンがフォーカス可能である
  - **何をテストするか**: キーボードナビゲーションでフォーカス可能であること
  - **期待される動作**: Tabキーでボタンにフォーカスできる
- **入力値**: なし
  - **入力データの意味**: 初期レンダリング状態
- **期待される結果**: `<button>`要素にtabindex="-1"が設定されていない
  - **期待結果の理由**: buttonはデフォルトでフォーカス可能だが、tabindex="-1"で無効化される可能性がある
- **テストの目的**: キーボードナビゲーション対応を確認
  - **確認ポイント**: tabindex属性の確認

#### TC-TT-104: ボタンtype属性確認
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: ボタンにtype="button"が設定されている
  - **何をテストするか**: フォーム送信を防止するためのtype属性
  - **期待される動作**: クリック時にフォーム送信が発生しない
- **入力値**: なし
  - **入力データの意味**: 初期レンダリング状態
- **期待される結果**: `type="button"`属性が設定されている
  - **期待結果の理由**: デフォルトのtype="submit"だとフォーム内での誤動作が発生する
- **テストの目的**: 意図しないフォーム送信を防止
  - **確認ポイント**: type属性の値

### 2.3 ThemeToggleコンポーネント - スタイリングテストケース

#### TC-TT-201: ホバースタイルクラス確認
🟡 **黄信号**: タスクノートの設計仕様から妥当な推測

- **テスト名**: ホバースタイルクラスが適用されている
  - **何をテストするか**: マウスホバー時のスタイル変更
  - **期待される動作**: ホバー時に背景色が変化する
- **入力値**: なし
  - **入力データの意味**: 初期レンダリング状態
- **期待される結果**: `hover:bg-gray-200`クラスが存在
  - **期待結果の理由**: UIフィードバックとして標準的なホバー効果
- **テストの目的**: インタラクティブなUI要素のフィードバックを確認
  - **確認ポイント**: hover:関連クラスの存在

#### TC-TT-202: ダークモードホバースタイルクラス確認
🟡 **黄信号**: タスクノートの設計仕様から妥当な推測

- **テスト名**: ダークモード用ホバースタイルクラスが適用されている
  - **何をテストするか**: ダークモード時のホバースタイル
  - **期待される動作**: ダークモードでホバー時に適切な背景色が適用される
- **入力値**: なし
  - **入力データの意味**: 初期レンダリング状態
- **期待される結果**: `dark:hover:bg-gray-700`クラスが存在
  - **期待結果の理由**: ダークモードでのコントラスト確保
- **テストの目的**: ダークモードでのUI一貫性を確認
  - **確認ポイント**: dark:hover:関連クラスの存在

#### TC-TT-203: パディングスタイル確認
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: ボタンに適切なパディングが設定されている
  - **何をテストするか**: ボタンのクリック領域
  - **期待される動作**: タッチデバイスでも押しやすいサイズ
- **入力値**: なし
  - **入力データの意味**: 初期レンダリング状態
- **期待される結果**: `p-2`クラスが存在
  - **期待結果の理由**: タスクノートの設計仕様で指定されている
- **テストの目的**: 操作性の確保
  - **確認ポイント**: パディングクラスの存在

### 2.4 localStorage連携テストケース

#### TC-LS-001: テーマ初期化スクリプトの存在確認
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: BaseLayoutにテーマ初期化スクリプトが存在する
  - **何をテストするか**: `<head>`内のインラインスクリプト
  - **期待される動作**: ページ読み込み時にテーマが即座に適用される
- **入力値**: なし
  - **入力データの意味**: BaseLayoutの初期レンダリング
- **期待される結果**: `<script is:inline>`タグが`<head>`内に存在
  - **期待結果の理由**: Astroの`is:inline`ディレクティブでビルド最適化をバイパス
- **テストの目的**: フラッシュ防止機能の基盤を確認
  - **確認ポイント**: scriptタグの存在、is:inline属性

#### TC-LS-002: localStorage参照コードの存在確認
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: 初期化スクリプトにlocalStorage参照が含まれる
  - **何をテストするか**: テーマ設定読み込みコード
  - **期待される動作**: 保存されたテーマ設定を読み込む
- **入力値**: なし
  - **入力データの意味**: スクリプトの内容
- **期待される結果**: `localStorage.getItem('theme')`コードがスクリプト内に存在
  - **期待結果の理由**: ユーザー設定の復元に必要
- **テストの目的**: テーマ永続化機能の基盤を確認
  - **確認ポイント**: localStorage.getItem呼び出しの存在

#### TC-LS-003: テーマクラストグルコードの存在確認
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: 初期化スクリプトにdarkクラス操作が含まれる
  - **何をテストするか**: テーマクラス切り替えコード
  - **期待される動作**: `<html>`要素の`dark`クラスを操作
- **入力値**: なし
  - **入力データの意味**: スクリプトの内容
- **期待される結果**: `classList.add('dark')`または`classList.toggle`コードが存在
  - **期待結果の理由**: Tailwind CSSのダークモード切り替えに必要
- **テストの目的**: テーマ切り替え機能の基盤を確認
  - **確認ポイント**: classList操作コードの存在

#### TC-LS-004: ThemeToggle内のlocalStorage書き込みコード確認
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: ThemeToggleにlocalStorage書き込みコードが含まれる
  - **何をテストするか**: テーマ設定保存コード
  - **期待される動作**: テーマ切り替え時に設定をlocalStorageに保存
- **入力値**: なし
  - **入力データの意味**: ThemeToggleのスクリプト内容
- **期待される結果**: `localStorage.setItem('theme',`コードが存在
  - **期待結果の理由**: ユーザー設定の永続化に必要
- **テストの目的**: テーマ永続化機能を確認
  - **確認ポイント**: localStorage.setItem呼び出しの存在

### 2.5 システム設定連携テストケース

#### TC-SYS-001: prefers-color-scheme対応の確認
🟡 **黄信号**: 要件定義書のエッジケースから推測

- **テスト名**: システム設定（prefers-color-scheme）への対応コードが存在する可能性を確認
  - **何をテストするか**: メディアクエリ参照コード
  - **期待される動作**: localStorageが未設定の場合にシステム設定を参照
- **入力値**: なし
  - **入力データの意味**: 初期化スクリプトの内容
- **期待される結果**: `matchMedia`または`prefers-color-scheme`への参照
  - **期待結果の理由**: ユーザー体験向上のためシステム設定を尊重する実装が望ましい
- **テストの目的**: システム設定連携の有無を確認
  - **確認ポイント**: matchMedia呼び出しまたはCSSメディアクエリ

**注意**: 要件定義書ではlocalStorageが未設定の場合は「デフォルトでダークモード」と明記されており、システム設定参照は必須ではない。このテストは推奨事項として記載。

### 2.6 フラッシュ防止テストケース

#### TC-FLASH-001: インラインスクリプトの配置確認
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: テーマ初期化スクリプトが`<head>`内に配置されている
  - **何をテストするか**: スクリプトの配置位置
  - **期待される動作**: DOMパース時に即座にテーマが適用される
- **入力値**: BaseLayoutコンポーネント
  - **入力データの意味**: レンダリング結果のHTML構造
- **期待される結果**: `<head>`タグ内に`<script is:inline>`が存在
  - **期待結果の理由**: `<body>`より前に実行されることでフラッシュを防止
- **テストの目的**: FOUC（Flash of Unstyled Content）防止を確認
  - **確認ポイント**: スクリプトの配置位置

#### TC-FLASH-002: is:inlineディレクティブ使用確認
🔵 **青信号**: タスクノート設計仕様より

- **テスト名**: Astroの`is:inline`ディレクティブが使用されている
  - **何をテストするか**: スクリプトのインライン化設定
  - **期待される動作**: ビルド時の最適化をバイパスし、HTMLに直接埋め込まれる
- **入力値**: BaseLayoutコンポーネント
  - **入力データの意味**: レンダリング結果のHTML
- **期待される結果**: `<script is:inline>`または`<script>` + インラインコード
  - **期待結果の理由**: 外部ファイル読み込みによる遅延を回避
- **テストの目的**: 初期化の即時性を確認
  - **確認ポイント**: is:inline属性またはインラインスクリプト

### 2.7 エッジケーステストケース

#### TC-EDGE-001: localStorageが利用不可能な場合
🟡 **黄信号**: 要件定義書EDGE-001より

- **テスト名**: localStorage利用不可時にデフォルトテーマが適用される
  - **エラーケースの概要**: プライベートブラウジング等でlocalStorageが制限される
  - **エラー処理の重要性**: ユーザーが正常にサイトを閲覧できること
- **入力値**: localStorageがnullまたは例外をスロー
  - **不正な理由**: ブラウザ設定によりストレージが無効化
  - **実際の発生シナリオ**: Safari プライベートブラウジング、一部企業環境
- **期待される結果**: ダークモード（デフォルト）が適用される
  - **エラーメッセージの内容**: コンソールにワーニングを出力（オプション）
  - **システムの安全性**: テーマ切り替えは動作するが永続化されない
- **テストの目的**: エラー耐性の確認
  - **品質保証の観点**: グレースフルデグラデーション

**実装時の注意**: このテストはlocalStorageのモックが必要

```typescript
// テスト実装時のモック例
beforeEach(() => {
  const localStorageMock = {
    getItem: vi.fn(() => { throw new Error('localStorage not available'); }),
    setItem: vi.fn(),
    removeItem: vi.fn(),
    clear: vi.fn(),
  };
  Object.defineProperty(window, 'localStorage', { value: localStorageMock, writable: true });
});
```

#### TC-EDGE-002: 初回訪問時（theme設定なし）
🔵 **青信号**: 要件定義書使用パターン1より

- **テスト名**: localStorage未設定時にデフォルトでダークモードが適用される
  - **境界値の意味**: 初回訪問ユーザーの体験
  - **境界値での動作保証**: tech-stack.mdの「ダークモードデフォルト」仕様を満たす
- **入力値**: `localStorage.getItem('theme')` が `null` を返す
  - **境界値選択の根拠**: 初回訪問時はlocalStorageにthemeキーが存在しない
  - **実際の使用場面**: 新規ユーザー、キャッシュクリア後
- **期待される結果**: `<html>`に`dark`クラスが追加される
  - **境界での正確性**: デフォルトテーマが正しく適用される
  - **一貫した動作**: 明示的にlightを選択した場合と区別される
- **テストの目的**: デフォルト動作の確認
  - **堅牢性の確認**: 初回訪問時のUXが意図通り

#### TC-EDGE-003: 不正なtheme値がlocalStorageに保存されている場合
🟡 **黄信号**: 一般的なエラー処理から推測

- **テスト名**: 不正なtheme値の場合にデフォルトテーマが適用される
  - **境界値の意味**: データ整合性のエッジケース
  - **境界値での動作保証**: 不正データによるクラッシュを防止
- **入力値**: `localStorage.getItem('theme')` が `'invalid_theme'` を返す
  - **境界値選択の根拠**: 'dark'/'light'以外の値
  - **実際の使用場面**: 手動でlocalStorageを編集した場合、古いバージョンからの移行
- **期待される結果**: デフォルトのダークモードが適用される
  - **境界での正確性**: 不正値は無視される
  - **一貫した動作**: 'null'と同じ挙動
- **テストの目的**: データ整合性エラーへの耐性確認
  - **堅牢性の確認**: 予期しない入力での安定動作

### 2.8 境界値テストケース

#### TC-BV-001: theme='dark'が保存されている場合
🔵 **青信号**: 要件定義書使用パターン4より

- **テスト名**: theme='dark'保存時にダークモードが復元される
  - **境界値の意味**: 正常なダークモード設定値
  - **境界値での動作保証**: ユーザー設定が正しく復元される
- **入力値**: `localStorage.getItem('theme')` が `'dark'` を返す
  - **境界値選択の根拠**: 有効な設定値の一つ
  - **実際の使用場面**: ダークモードを明示的に選択したユーザー
- **期待される結果**: `<html>`に`dark`クラスが設定される
  - **境界での正確性**: ダークモードスタイルが適用される
  - **一貫した動作**: フラッシュなしで表示
- **テストの目的**: 設定復元の正確性確認
  - **堅牢性の確認**: ユーザー設定の永続化が機能している

#### TC-BV-002: theme='light'が保存されている場合
🔵 **青信号**: 要件定義書使用パターン4より

- **テスト名**: theme='light'保存時にライトモードが復元される
  - **境界値の意味**: 正常なライトモード設定値
  - **境界値での動作保証**: ユーザー設定が正しく復元される
- **入力値**: `localStorage.getItem('theme')` が `'light'` を返す
  - **境界値選択の根拠**: 有効な設定値の一つ
  - **実際の使用場面**: ライトモードを明示的に選択したユーザー
- **期待される結果**: `<html>`に`dark`クラスが設定されない
  - **境界での正確性**: ライトモードスタイルが適用される
  - **一貫した動作**: フラッシュなしで表示
- **テストの目的**: 設定復元の正確性確認
  - **堅牢性の確認**: ユーザー設定の永続化が機能している

---

## 3. テストケース実装時の日本語コメント指針

### 3.1 テストファイルヘッダー

```typescript
/**
 * ThemeToggle.astro - テストスイート
 *
 * 関連要件:
 * - tech-stack.md: ダークモードデフォルト
 * - NFR-302: キーボードナビゲーション対応
 * - NFR-303: ARIAラベル設定
 * - NFR-304: フォーカス可視化
 *
 * 関連文書:
 * - テストケース定義書: docs/implements/blog-article-management/TASK-0005/darkmode-toggle-testcases.md
 * - 要件定義書: docs/implements/blog-article-management/TASK-0005/darkmode-toggle-requirements.md
 * - タスクノート: docs/implements/blog-article-management/TASK-0005/note.md
 */
```

### 3.2 テストケース開始時のコメント

```typescript
// 【テスト目的】: ThemeToggleコンポーネントの基本構造を確認
// 【テスト内容】: button要素が正しくレンダリングされることを検証
// 【期待される動作】: id="theme-toggle"を持つbutton要素が存在する
// 🔵 青信号: タスクノート設計仕様より
```

### 3.3 Given（準備フェーズ）のコメント

```typescript
// 【テストデータ準備】: AstroContainerを作成してコンポーネントをレンダリング
// 【初期条件設定】: ThemeToggleはPropsを受け取らない
// 【前提条件確認】: Astro Container APIが利用可能
```

### 3.4 When（実行フェーズ）のコメント

```typescript
// 【実際の処理実行】: ThemeToggleコンポーネントをレンダリング
// 【処理内容】: 静的HTMLへのレンダリングを実行
// 【実行タイミング】: beforeEachで作成したcontainerを使用
```

### 3.5 Then（検証フェーズ）のコメント

```typescript
// 【結果検証】: button要素の存在を確認
// 【期待値確認】: id="theme-toggle"属性が設定されている
// 【品質保証】: 基本構造が正しければ後続の機能テストが有効
```

### 3.6 各expectステートメントのコメント

```typescript
// 【検証項目】: button要素のid属性
// 🔵 青信号: タスクノートで明確に定義
expect(result).toContain('id="theme-toggle"'); // 【確認内容】: テーマ切り替えボタンのid属性

// 【検証項目】: aria-label属性の設定
// 🔵 青信号: NFR-303準拠
expect(result).toContain('aria-label="テーマを切り替える"'); // 【確認内容】: アクセシビリティ用ラベル
```

### 3.7 セットアップ・クリーンアップのコメント

```typescript
beforeEach(async () => {
  // 【テスト前準備】: 各テスト用にAstroContainerを新規作成
  // 【環境初期化】: テスト間の独立性を確保
  container = await AstroContainer.create();
});

afterEach(() => {
  // 【テスト後処理】: モックをリセット
  // 【状態復元】: localStorage等のグローバル状態をクリア
  vi.restoreAllMocks();
});
```

---

## 4. 要件定義との対応関係

### 4.1 参照した機能概要

| 要件定義セクション | テストケース |
|------------------|------------|
| 1. 機能の概要 | TC-TT-001, TC-TT-002 |
| ThemeToggle設計仕様 | TC-TT-003, TC-TT-004 |

### 4.2 参照した入力・出力仕様

| 要件定義セクション | テストケース |
|------------------|------------|
| 2. 入力・出力の仕様 - DOM操作 | TC-LS-003, TC-LS-004 |
| 2. 入力・出力の仕様 - レンダリング出力 | TC-TT-003, TC-TT-004 |

### 4.3 参照した制約条件

| 要件定義セクション | テストケース |
|------------------|------------|
| 3. 制約条件 - アクセシビリティ要件 | TC-TT-101, TC-TT-102, TC-TT-103 |
| 3. 制約条件 - アーキテクチャ制約 | TC-FLASH-001, TC-FLASH-002 |

### 4.4 参照した使用例

| 要件定義セクション | テストケース |
|------------------|------------|
| 4. 想定される使用例 - パターン1 | TC-EDGE-002 |
| 4. 想定される使用例 - パターン4 | TC-BV-001, TC-BV-002 |
| 4. 想定される使用例 - EDGE-001 | TC-EDGE-001 |

---

## 5. テストケースサマリー

### 5.1 カテゴリ別テストケース数

| カテゴリ | テストケース数 |
|---------|--------------|
| ThemeToggle - 正常系 | 4件 |
| ThemeToggle - アクセシビリティ | 4件 |
| ThemeToggle - スタイリング | 3件 |
| localStorage連携 | 4件 |
| システム設定連携 | 1件 |
| フラッシュ防止 | 2件 |
| エッジケース | 3件 |
| 境界値 | 2件 |
| **合計** | **23件** |

### 5.2 信頼性レベル分布

| レベル | テストケース数 | 割合 |
|--------|--------------|------|
| 🔵 青信号 | 18件 | 78% |
| 🟡 黄信号 | 5件 | 22% |
| 🔴 赤信号 | 0件 | 0% |

---

## 6. 品質判定結果

### 評価: ✅ 高品質

**評価理由**:

1. **テストケース分類**: 正常系・異常系・境界値が網羅されている
   - 正常系: 11件（基本レンダリング、アクセシビリティ、スタイリング）
   - 異常系: 4件（localStorage利用不可、不正値）
   - 境界値: 4件（theme='dark'/'light'/null/invalid）

2. **期待値定義**: 各テストケースの期待値が明確
   - HTML要素の存在確認
   - CSS クラスの正確性
   - 属性値の検証

3. **技術選択**: プログラミング言語・テストフレームワークが確定
   - TypeScript 5.7+ / Vitest 2.1.8 / happy-dom 20.0.11

4. **実装可能性**: 現在の技術スタックで実現可能
   - AstroContainer APIによるコンポーネントテスト
   - vi.fnによるlocalStorageモック

5. **信頼性レベル**: 🔵（青信号）が78%で大多数
   - タスクノート・要件定義書から確実に導出された項目が中心
   - 推測（🟡）は一般的なエラー処理パターンのみ

---

## 7. 次のステップ

テストケース定義が完了しました。

**次のお勧めステップ**: `/tsumiki:tdd-red blog-article-management TASK-0005` でRedフェーズ（失敗テスト作成）を開始します。

---

**最終更新日**: 2025-12-31
**作成者**: Claude Opus 4.5 (TDD開発エージェント)
