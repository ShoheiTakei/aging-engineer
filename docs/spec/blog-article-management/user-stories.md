# ブログ記事管理機能 ユーザストーリー

**作成日**: 2025-12-28
**関連要件定義**: [requirements.md](requirements.md)
**ヒアリング記録**: [interview-record.md](interview-record.md)

**【信頼性レベル凡例】**:
- 🔵 **青信号**: PRD・EARS要件定義書・設計文書・ユーザヒアリングを参考にした確実なストーリー
- 🟡 **黄信号**: PRD・EARS要件定義書・設計文書・ユーザヒアリングから妥当な推測によるストーリー
- 🔴 **赤信号**: PRD・EARS要件定義書・設計文書・ユーザヒアリングにない推測によるストーリー

---

## エピック1: 記事執筆・管理

### ストーリー 1.1: Markdownで記事を作成する 🔵

**信頼性**: 🔵 *tech-stack.md・ユーザヒアリング Q1-Q4より*

**私は** ブログ著者 **として**
**ローカル環境でVimを使用してMarkdown形式で記事を作成したい**
**そうすることで** Gitでバージョン管理しながら効率的に記事を執筆できる

**関連要件**: REQ-001, REQ-002, REQ-003

**詳細シナリオ**:
1. ローカルの`src/content/blog/`ディレクトリに新しい`.md`ファイルを作成
2. frontmatterで記事メタデータを記述（title, description, pubDate, tags等）
3. Vimで記事本文をMarkdownで執筆
4. コードブロック、画像、リンク等のMarkdown記法を使用
5. ローカルで`pnpm dev`を実行してプレビュー確認
6. Gitにコミット・プッシュ
7. Cloudflare Pagesで自動ビルド・デプロイ

**前提条件**:
- Node.js 22 LTS、pnpm 9+がインストール済み
- Astroプロジェクトが初期化済み
- Content Collections APIが設定済み

**優先度**: Must Have

---

### ストーリー 1.2: 下書き記事を管理する 🔵

**信頼性**: 🔵 *ユーザヒアリング Q4より*

**私は** ブログ著者 **として**
**公開前の記事を下書き状態で保存したい**
**そうすることで** 執筆途中の記事をGitで管理しながら、本番環境では非公開にできる

**関連要件**: REQ-501, REQ-502

**詳細シナリオ**:
1. frontmatterに`draft: true`を設定
2. 開発環境（`pnpm dev`）で下書き記事がプレビュー可能
3. Gitにプッシュしても本番環境では非表示
4. 公開準備ができたら`draft: false`に変更（またはフィールドを削除）
5. 再度Gitにプッシュして本番環境に公開

**優先度**: Must Have

---

### ストーリー 1.3: 記事にCloudflare R2の画像を埋め込む 🔵

**信頼性**: 🔵 *tech-stack.md・ユーザヒアリングより*

**私は** ブログ著者 **として**
**記事にCloudflare R2にアップロードした画像を埋め込みたい**
**そうすることで** Gitリポジトリのサイズを抑えつつ、高速な画像配信ができる

**関連要件**: REQ-003, NFR-201, NFR-202

**詳細シナリオ**:
1. 画像をCloudflare R2バケットにアップロード
2. R2のパブリックURLを取得
3. frontmatterの`coverImage`にURLを設定、または本文に`![alt](R2 URL)`で埋め込み
4. Astro Imageコンポーネントが自動的にWebP/AVIF最適化を実施
5. レスポンシブ対応の画像が表示される

**優先度**: Must Have

---

### ストーリー 1.4: 既存記事を更新する 🔵

**信頼性**: 🔵 *ユーザヒアリングより*

**私は** ブログ著者 **として**
**既存の記事を編集して更新したい**
**そうすることで** 誤字修正や内容追加が簡単にできる

**関連要件**: REQ-010

**詳細シナリオ**:
1. ローカルの`src/content/blog/existing-post.md`を開く
2. Vimで内容を編集
3. frontmatterの`updatedDate`を更新
4. Gitにコミット・プッシュ
5. 自動デプロイ後、サイトに反映

**優先度**: Must Have

---

### ストーリー 1.5: 記事を削除する 🔵

**信頼性**: 🔵 *ユーザヒアリングより*

**私は** ブログ著者 **として**
**不要になった記事を削除したい**
**そうすることで** サイトから記事を完全に削除できる

**関連要件**: REQ-011

**詳細シナリオ**:
1. ローカルの`src/content/blog/old-post.md`を削除
2. Gitにコミット・プッシュ
3. 自動デプロイ後、サイトから記事が削除される

**優先度**: Should Have

---

## エピック2: 記事閲覧

### ストーリー 2.1: 記事一覧を閲覧する 🔵

**信頼性**: 🔵 *ユーザヒアリング Q1, Q11, Q12より*

**私は** サイト訪問者 **として**
**ブログの記事一覧を新しい順で閲覧したい**
**そうすることで** 最新の記事をすぐに見つけられる

**関連要件**: REQ-101, REQ-102, REQ-103, REQ-201

**詳細シナリオ**:
1. `/blog/`にアクセス
2. 最新5件の記事が表示される（タイトル、説明、公開日、タグ、カバー画像、読了時間）
3. 記事は公開日の新しい順に並んでいる
4. ページネーションボタンで次のページに移動可能

**優先度**: Must Have

---

### ストーリー 2.2: 記事詳細を読む 🔵

**信頼性**: 🔵 *ユーザヒアリング Q9, Q10, Q18より*

**私は** サイト訪問者 **として**
**記事の詳細ページで本文を快適に読みたい**
**そうすることで** 記事の内容を理解できる

**関連要件**: REQ-110, REQ-111, REQ-112, REQ-801, REQ-901

**詳細シナリオ**:
1. 記事一覧から記事をクリック
2. `/blog/[slug]/`にアクセス
3. 以下が表示される:
   - タイトル、公開日、更新日、タグ
   - 読了時間（例: "約3分で読めます"）
   - 目次（h2, h3見出しから自動生成、クリックで該当箇所にジャンプ）
   - 本文（Markdownから変換されたHTML、シンタックスハイライト付きコードブロック）
   - 関連記事リスト

**優先度**: Must Have

---

### ストーリー 2.3: タグで記事を絞り込む 🔵

**信頼性**: 🔵 *ユーザヒアリング Q2より*

**私は** サイト訪問者 **として**
**特定のタグが付いた記事のみを閲覧したい**
**そうすることで** 興味のあるトピックの記事を効率的に見つけられる

**関連要件**: REQ-301, REQ-302, REQ-303

**詳細シナリオ**:
1. `/tags/`にアクセスして全タグ一覧を表示
2. 興味のあるタグ（例: "TypeScript"）をクリック
3. `/tags/typescript/`にアクセス
4. "TypeScript"タグが付いた記事のみが一覧表示される
5. ページネーション機能で複数ページを閲覧可能

**優先度**: Must Have

---

### ストーリー 2.4: 記事を検索する 🔵

**信頼性**: 🔵 *ユーザヒアリング Q3より*

**私は** サイト訪問者 **として**
**キーワードで記事を検索したい**
**そうすることで** 探している情報をすぐに見つけられる

**関連要件**: REQ-401, REQ-402

**詳細シナリオ**:
1. サイトヘッダーの検索ボックスにキーワード（例: "Astro"）を入力
2. Enterキーを押すと検索実行
3. タイトルと本文から全文検索され、結果が関連度順に表示
4. 検索キーワードがハイライト表示される

**優先度**: Must Have

---

### ストーリー 2.5: 関連記事を見つける 🔵

**信頼性**: 🔵 *ユーザヒアリング Q6より*

**私は** サイト訪問者 **として**
**読んでいる記事に関連する他の記事を見つけたい**
**そうすることで** 同じトピックの記事を続けて読める

**関連要件**: REQ-701

**詳細シナリオ**:
1. 記事詳細ページの下部に「関連記事」セクションが表示される
2. 現在の記事とタグが一致する記事が最大5件表示される
3. タグが多く一致する記事が優先的に表示される
4. 関連記事をクリックして次の記事に移動

**優先度**: Should Have

---

## エピック3: 便利機能

### ストーリー 3.1: RSS Feedで記事を購読する 🔵

**信頼性**: 🔵 *ユーザヒアリング Q5より*

**私は** サイト訪問者 **として**
**RSSリーダーでブログの更新を購読したい**
**そうすることで** 新しい記事がすぐに通知される

**関連要件**: REQ-601

**詳細シナリオ**:
1. `/rss.xml`にアクセス
2. RSS 2.0フィードが表示される（最新20件）
3. RSSリーダー（Feedly、Inoreader等）にURLを追加
4. 新しい記事が公開されるとリーダーに通知される

**優先度**: Should Have

---

### ストーリー 3.2: 読了時間を確認する 🔵

**信頼性**: 🔵 *ユーザヒアリング Q9より*

**私は** サイト訪問者 **として**
**記事を読むのにかかる時間を事前に知りたい**
**そうすることで** 読む時間を計画できる

**関連要件**: REQ-801

**詳細シナリオ**:
1. 記事一覧または記事詳細ページで読了時間を確認
2. "約3分で読めます"のように表示される
3. 文字数から自動計算（日本語: 500文字/分）

**優先度**: Should Have

---

### ストーリー 3.3: 目次で記事をナビゲートする 🔵

**信頼性**: 🔵 *ユーザヒアリング Q10より*

**私は** サイト訪問者 **として**
**長文記事の目次を使って興味のある箇所にジャンプしたい**
**そうすることで** 効率的に記事を読める

**関連要件**: REQ-901

**詳細シナリオ**:
1. 記事詳細ページの上部に目次が表示される
2. h2, h3見出しが階層構造で一覧表示
3. 目次項目をクリックすると該当箇所にスムーズスクロール
4. スクロール位置に応じて現在地がハイライト表示

**優先度**: Should Have

---

## エピック4: パフォーマンス・アクセシビリティ

### ストーリー 4.1: 高速なページ表示を体験する 🔵

**信頼性**: 🔵 *tech-stack.md品質基準、ユーザヒアリング Q13より*

**私は** サイト訪問者 **として**
**記事ページが素早く表示されることを期待する**
**そうすることで** ストレスなく記事を読める

**関連要件**: NFR-001, NFR-002

**詳細シナリオ**:
1. 記事詳細ページにアクセス
2. 3秒以内にページが完全に表示される
3. Lighthouse Performance スコアが90+点
4. 画像が最適化されており、遅延読み込みされる

**優先度**: Must Have

---

### ストーリー 4.2: アクセシブルなサイトを利用する 🔵

**信頼性**: 🔵 *tech-stack.md品質基準、ユーザヒアリング Q16より*

**私は** スクリーンリーダー利用者 **として**
**キーボードのみでサイトを操作したい**
**そうすることで** すべての機能にアクセスできる

**関連要件**: NFR-301, NFR-302, NFR-303, NFR-304

**詳細シナリオ**:
1. Tabキーでナビゲーション要素間を移動
2. Enterキーでリンク・ボタンを実行
3. スクリーンリーダーでARIAラベルが読み上げられる
4. 画像の代替テキストが適切に設定されている
5. セマンティックHTMLによる正しい文書構造

**優先度**: Must Have

---

### ストーリー 4.3: 検索エンジンで記事を見つける 🔵

**信頼性**: 🔵 *tech-stack.md、ユーザヒアリング Q14より*

**私は** サイト訪問者 **として**
**Googleなどの検索エンジンで記事を見つけたい**
**そうすることで** 欲しい情報にすぐにアクセスできる

**関連要件**: NFR-101, NFR-102, NFR-103, NFR-104

**詳細シナリオ**:
1. 記事詳細ページが適切なメタタグを持つ
2. サイトマップ（`/sitemap.xml`）に全記事が含まれる
3. OGPメタタグによりSNSシェア時に適切に表示される
4. JSON-LD構造化データにより検索エンジンが記事を正しく理解
5. 検索結果に記事が表示される

**優先度**: Must Have

---

## ストーリーマップ

```
エピック1: 記事執筆・管理
├── ストーリー 1.1 (🔵 Must Have) Markdownで記事を作成
├── ストーリー 1.2 (🔵 Must Have) 下書き記事を管理
├── ストーリー 1.3 (🔵 Must Have) Cloudflare R2の画像を埋め込み
├── ストーリー 1.4 (🔵 Must Have) 既存記事を更新
└── ストーリー 1.5 (🔵 Should Have) 記事を削除

エピック2: 記事閲覧
├── ストーリー 2.1 (🔵 Must Have) 記事一覧を閲覧
├── ストーリー 2.2 (🔵 Must Have) 記事詳細を読む
├── ストーリー 2.3 (🔵 Must Have) タグで記事を絞り込み
├── ストーリー 2.4 (🔵 Must Have) 記事を検索
└── ストーリー 2.5 (🔵 Should Have) 関連記事を見つける

エピック3: 便利機能
├── ストーリー 3.1 (🔵 Should Have) RSS Feedで購読
├── ストーリー 3.2 (🔵 Should Have) 読了時間を確認
└── ストーリー 3.3 (🔵 Should Have) 目次でナビゲート

エピック4: パフォーマンス・アクセシビリティ
├── ストーリー 4.1 (🔵 Must Have) 高速なページ表示
├── ストーリー 4.2 (🔵 Must Have) アクセシブルなサイト
└── ストーリー 4.3 (🔵 Must Have) 検索エンジンで発見
```

## 信頼性レベルサマリー

- 🔵 青信号: 17件 (100%)
- 🟡 黄信号: 0件 (0%)
- 🔴 赤信号: 0件 (0%)

**品質評価**: ✅ 高品質 - すべてのストーリーがユーザヒアリングと既存設計に基づいており、信頼性が非常に高い
